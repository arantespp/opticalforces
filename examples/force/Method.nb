(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40241,        917]
NotebookOptionsPosition[     39507,        891]
NotebookOutlinePosition[     39844,        906]
CellTagsIndexPosition[     39801,        903]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "299792458"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"force", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Rho]0", ",", " ", "\[Phi]0", ",", " ", "z0", ",", " ", "\[Alpha]"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E0", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rp", "=", 
        RowBox[{"6", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nm", "=", "1.33"}], ";", "\[IndentingNewLine]", 
       RowBox[{"np", "=", "1.6"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"488", " ", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]], "/", "1.33"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]0", "=", 
        RowBox[{"0.4", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"\[Omega]", "[", "z_", "]"}], "=", 
        RowBox[{"\[Omega]0", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"\[Lambda]", " ", "z"}], 
              RowBox[{"\[Pi]", " ", 
               SuperscriptBox["\[Omega]0", "2"]}]], ")"}], "2"]}]]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "z_", "]"}], "=", 
        RowBox[{"z", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"\[Pi]", " ", 
               SuperscriptBox["\[Omega]0", "2"]}], 
              RowBox[{"\[Lambda]", " ", "z"}]], ")"}], "2"]}], ")"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]\[Phi]", "[", "z_", "]"}], "=", 
        RowBox[{"ArcTan", "[", 
         FractionBox[
          RowBox[{"\[Lambda]", " ", "z"}], 
          RowBox[{"\[Pi]", " ", 
           SuperscriptBox["\[Omega]0", "2"]}]], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Phi", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", " ", "z_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"k", 
          RowBox[{"(", 
           RowBox[{"z", "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}], 
             RowBox[{"2", " ", 
              RowBox[{"r", "[", "z", "]"}]}]]}], ")"}]}], "-", 
         RowBox[{"\[CapitalDelta]\[Phi]", "[", "z", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"E00", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
        RowBox[{
         FractionBox["\[Omega]0", 
          RowBox[{"\[Omega]", "[", "z", "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}], 
            SuperscriptBox[
             RowBox[{"\[Omega]", "[", "z", "]"}], "2"]]}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           RowBox[{"Phi", "[", 
            RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"\[Rho]_", ",", " ", "\[Phi]_", ",", " ", "z_"}], "]"}], "=", 
        RowBox[{"E00", "[", 
         RowBox[{
          RowBox[{"\[Rho]", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", " ", 
          RowBox[{"\[Rho]", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", "z"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "]"}], "=", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"k", " ", "x"}], 
              RowBox[{"r", "[", "z", "]"}]], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"k", " ", "y"}], 
              RowBox[{"r", "[", "z", "]"}]], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"k", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 FractionBox["2", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"k", " ", "\[Omega]0"}], ")"}], "2"]], 
                 FractionBox["1", 
                  RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{"z", " ", "\[Lambda]"}], 
                    RowBox[{"\[Pi]", " ", 
                    SuperscriptBox["\[Omega]0", "2"]}]], ")"}], "2"]}]]}], 
                "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   SuperscriptBox["x", "2"], "+", 
                   SuperscriptBox["y", "2"]}], 
                  RowBox[{"2", " ", 
                   SuperscriptBox[
                    RowBox[{"r", "[", "z", "]"}], "2"]}]], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{"\[Pi]", " ", 
                    SuperscriptBox["\[Omega]0", "2"]}], 
                    RowBox[{"\[Lambda]", " ", "z"}]], ")"}], "2"]}], 
                  ")"}]}]}], ")"}]}], ")"}], "2"]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kx", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "]"}], "=", 
        FractionBox[
         RowBox[{"k", " ", "x"}], 
         RowBox[{
          RowBox[{"\[Xi]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], 
          RowBox[{"r", "[", "z", "]"}]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ky", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "]"}], "=", 
        FractionBox[
         RowBox[{"k", " ", "y"}], 
         RowBox[{
          RowBox[{"\[Xi]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], 
          RowBox[{"r", "[", "z", "]"}]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kz", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "]"}], "=", 
        RowBox[{
         FractionBox["k", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox["2", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"k", " ", "\[Omega]0"}], ")"}], "2"]], 
            FractionBox["1", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"z", " ", "\[Lambda]"}], 
                 RowBox[{"\[Pi]", " ", 
                  SuperscriptBox["\[Omega]0", "2"]}]], ")"}], "2"]}]]}], "-", 
           
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}], 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"r", "[", "z", "]"}], "2"]}]], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", 
                  SuperscriptBox["\[Omega]0", "2"]}], 
                 RowBox[{"\[Lambda]", " ", "z"}]], ")"}], "2"]}], ")"}]}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k00", "[", 
         RowBox[{"x_", ",", " ", "y_", ",", "z_"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kx", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"ky", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"kz", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"point", " ", "at", " ", "surface", " ", "particle"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointx", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"\[Rho]0", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"Pi", "-", "\[Phi]0"}], "]"}]}], "+", 
         RowBox[{"Rp", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointy", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"\[Rho]0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"Pi", "-", "\[Phi]0"}], "]"}]}], "+", 
         RowBox[{"Rp", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointz", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{"-", "z0"}], " ", "+", " ", 
         RowBox[{"Rp", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"k0", " ", "at", " ", "surface", " ", "particle"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k0", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"k00", "[", 
         RowBox[{
          RowBox[{"pointx", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
          RowBox[{"pointy", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
          RowBox[{"pointz", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"n0", ":", " ", 
         RowBox[{"normal", " ", "at", " ", "surface", " ", "particle"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n0", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"d0", ":", " ", 
         RowBox[{"ortonormal", " ", "to", " ", "k0"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d0", "[", 
         RowBox[{"\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{
          RowBox[{"n0", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"n0", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
             RowBox[{"k0", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], " ", 
           RowBox[{"k0", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "beta", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pn", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"n0", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
          RowBox[{"k0", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"pn", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", "E0"}], 
            "]"}], "/", 
           RowBox[{"Norm", "[", 
            RowBox[{"pn", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "thetai", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thetai", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"-", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"n0", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
            RowBox[{"k0", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "thetar", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thetar", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"Re", "[", 
         RowBox[{"ArcSin", "[", 
          RowBox[{
           RowBox[{"nm", "/", "np"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"thetai", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"parallel", " ", "reflectance"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Rpa", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tan", "[", 
            RowBox[{
             RowBox[{"thetai", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
             RowBox[{"thetar", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], "/", 
           RowBox[{"Tan", "[", 
            RowBox[{
             RowBox[{"thetai", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "+", 
             RowBox[{"thetar", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], ")"}], 
         "^", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"perpendicular", " ", "reflectance"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Rpe", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"thetai", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
             RowBox[{"thetar", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], "/", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"thetai", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "+", 
             RowBox[{"thetar", "[", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], ")"}], 
         "^", "2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "reflectivity", " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Rpe", "[", 
           RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{"beta", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], "]"}], "2"]}], 
         "+", 
         RowBox[{
          RowBox[{"Rpa", "[", 
           RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{"beta", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], "]"}], 
           "2"]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "transmissivity", " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"\[Theta]_", ",", " ", "\[Phi]_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Rpe", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{"beta", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], "]"}], "2"]}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Rpa", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{"beta", "[", 
             RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], "]"}], "]"}], 
           "2"]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Qt", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"length", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"2", "*", "Rp", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{"thetar", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Qt", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", 
            RowBox[{"thetai", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"T", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "2"], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[Alpha]"}], "*", 
            RowBox[{"length", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], " ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"thetai", "[", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
               RowBox[{"thetar", "[", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}]}], "]"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[Alpha]"}], "*", 
                RowBox[{"length", "[", 
                 RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"\[ImaginaryI]", " ", "2", "*", 
                RowBox[{"thetar", "[", 
                 RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}]}]}], 
            ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "intensity", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"intensity", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"E00", "[", 
           RowBox[{
            RowBox[{"pointx", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
            RowBox[{"pointy", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
            RowBox[{"pointz", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], "]"}], "]"}], 
         "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "dforce", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dforce", "[", 
         RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"thetai", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "<", 
           RowBox[{"Pi", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Qt", "[", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], "*", 
              RowBox[{"k0", "[", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], " ", "-", " ", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"Qt", "[", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], "*", 
              RowBox[{"d0", "[", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}]}], ")"}], "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"thetai", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], "*", 
           RowBox[{"nm", "/", "c"}], "*", 
           RowBox[{"intensity", "[", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fx", "=", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"dforce", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
           RowBox[{"Cos", "[", 
            RowBox[{"thetai", "[", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]", ",", "0", ",", 
            RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "fx"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"force", "[", 
   RowBox[{
    RowBox[{"0", "*", "1.575", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "05"}]}]}], ",", " ", "0", ",", " ", 
    RowBox[{
     RowBox[{"-", "6"}], "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "06"}]}]}], ",", " ", "500000"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzltIk3EYBvAVsQ2RQS66WvOQfoUN84BaN5E42kK3ZeZoGIrCKmOHLxVq
KaiRSsxNcKw8YLUleYDYnEeYwkeEQ3GCxkTmCAVPLO0icBduLr/nf/Hyg+eB
hze11vhQe57D4VDswUjR3v3c7j9FU1RQAUsL28vhjynuY9j4PlQJDx3JT+CS
ZbkGhjdjxESZ7AW8Y/5OwyNftAO2e7RWODl4YIei7a4P0C2/+hXm1zCjcFjp
cMOxQNYibHjrXIHVfd4ApHszfhNXRk7IHzz1uTzW4PTFTDh7b6AQ2roCt+G7
tUMpjJxQZtLrJmIK1te6T/+J8YQEJWtBt5OCzPh0JowVC+/C0r4HUuj0i+RQ
8nlXDcX6sAYuMP3PSS4Q18HQP/5LyLusaYA0c+UVfKNPa4b8lC0LlAuae2De
tXUXbN0uc5M9f/kkDBssM7BCZfTCls0o8UuucAFeN/T64FOPchVmBLm/oK6k
cxemNtqI+U3pR3Dw2P8XzstEp9AeV8WhaeM0UcU6NHtTAPUiiRhW3TKnwez+
agqaluky+GhuVQ13Ln2shZ6CC8/gt9Yb9fCnqa0TJoX3LdCaYxuCG64B4hkS
YDVA
  "]],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","zeroregion",
   "\"Integration region \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"3.141592653589793`\\\", \\\",\\\", \
\\\"3.14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\) cannot be further subdivided at the specified working precision. \
NIntegrate assumes zero integral there and on any further indivisible \
regions.\"",2,1805,98,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699014983502393*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumri",
   "\"The integrand \\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"If\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"ArcCos\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\
\"-\\\", \\\"1.712425503800994`*^7\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"-\\\", RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"-\\\", \
RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}], \
\\\"<\\\", FractionBox[\\\"\[Pi]\\\", \\\"2\\\"]}], \\\",\\\", \
FractionBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"c\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\")\\\"}]}]\\) has evaluated to Overflow, \
Indeterminate, or Infinity for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"3.\
14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\", \\\",\\\", \
\\\"3.14159264224521042668762746000930786635652047777966799912974238396`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\).\"",2,1805,99,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.69901498397221*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","zeroregion",
   "\"Integration region \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"3.141592653589793`\\\", \\\",\\\", \
\\\"3.14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\) cannot be further subdivided at the specified working precision. \
NIntegrate assumes zero integral there and on any further indivisible \
regions.\"",2,1805,100,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015018073847*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumri",
   "\"The integrand \\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"If\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"ArcCos\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\
\"-\\\", \\\"1.712425503800994`*^7\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"-\\\", RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"-\\\", \
RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}], \
\\\"<\\\", FractionBox[\\\"\[Pi]\\\", \\\"2\\\"]}], \\\",\\\", \
FractionBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"c\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\")\\\"}]}]\\) has evaluated to Overflow, \
Indeterminate, or Infinity for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"3.\
14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\", \\\",\\\", \
\\\"3.14159264224521042668762746000930786635652047777966799912974238396`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\).\"",2,1805,101,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6990150185655403`*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","zeroregion",
   "\"Integration region \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"3.141592653589793`\\\", \\\",\\\", \
\\\"3.14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\) cannot be further subdivided at the specified working precision. \
NIntegrate assumes zero integral there and on any further indivisible \
regions.\"",2,1805,102,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015051620483*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"zeroregion\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,1805,103,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015051632843*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumri",
   "\"The integrand \\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"If\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"ArcCos\\\", \\\"[\\\", RowBox[{RowBox[{RowBox[{\\\
\"-\\\", \\\"1.712425503800994`*^7\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\"-\\\", RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Power\\\
\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"-\\\", \
RowBox[{\\\"1.712425503800994`*^7\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\"]\\\"}], \
\\\"<\\\", FractionBox[\\\"\[Pi]\\\", \\\"2\\\"]}], \\\",\\\", \
FractionBox[RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"c\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\")\\\"}]}]\\) has evaluated to Overflow, \
Indeterminate, or Infinity for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"3.\
14159265358977474234822973639676381358523275831641190908825878036`65.\
954589770191\\\", \\\",\\\", \
\\\"3.14159264224521042668762746000930786635652047777966799912974238396`65.\
954589770191\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"6.283185307179586`\\\"}], \\\"}\\\"}]}], \\\
\"}\\\"}]\\).\"",2,1805,104,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015052122167*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumri\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,1805,105,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6990150521365833`*^9}],

Cell[BoxData[
 TemplateBox[{
  "CompiledFunction","cfse",
   "\"Compiled expression \\!\\(\\*RowBox[{\\\"NIntegrate\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"dforce\\\", \\\"[\\\", RowBox[{\\\"\
\[Theta]\\\", \\\",\\\", \\\"\[Phi]\\\"}], \\\"]\\\"}], \\\".\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\"}], \
\\\"}\\\"}]}], \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"thetai\\\", \\\"[\\\", RowBox[{\\\"\[Theta]\\\", \\\",\\\", \\\"\
\[Phi]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"\[Theta]\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"\[Pi]\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[Phi]\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"\[Pi]\\\"}]}], \
\\\"}\\\"}]}], \\\"]\\\"}]\\) should be a \
\\!\\(\\*RowBox[{\\\"\\\\\\\"machine-size real number\\\\\\\"\\\"}]\\).\"",2,
   1805,106,24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015085930887*^9}],

Cell[BoxData[
 TemplateBox[{
  "CompiledFunction","cfex",
   "\"Could not complete external evaluation at instruction \\!\\(\\*RowBox[{\
\\\"38\\\"}]\\); proceeding with uncompiled evaluation.\"",2,1805,107,
   24169966545850786917,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699015085942368*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6990151281226177`*^9}]
}, Open  ]]
},
WindowSize->{682, 715},
WindowMargins->{{1, Automatic}, {1, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 23999, 613, 2179, "Input"],
Cell[24582, 637, 697, 12, 95, "Message"],
Cell[25282, 651, 3541, 52, 234, "Message"],
Cell[28826, 705, 698, 12, 95, "Message"],
Cell[29527, 719, 3545, 52, 234, "Message"],
Cell[33075, 773, 698, 12, 95, "Message"],
Cell[33776, 787, 352, 7, 40, "Message"],
Cell[34131, 796, 3543, 52, 234, "Message"],
Cell[37677, 850, 350, 7, 40, "Message"],
Cell[38030, 859, 1052, 17, 58, "Message"],
Cell[39085, 878, 324, 7, 41, "Message"],
Cell[39412, 887, 79, 1, 65, "Output"]
}, Open  ]]
}
]
*)

